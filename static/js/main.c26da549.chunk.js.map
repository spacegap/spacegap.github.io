{"version":3,"sources":["services/filecoin/economics.js","services/filecoin/stats.js","services/filecoin/index.js","components/Summary.js","views/Home.js","components/WindowPoStStatus.js","views/Status.js","components/WindowPoSt.js","views/Full.js","components/MinerBar.js","views/Deadline.js","views/MinerInfo.js","services/drand/index.js","components/TinySummary.js","views/Gas.js","App.js","serviceWorker.js","index.js"],"names":["computeEffectiveNetworkTime","cumsumRealized","x0","k","Math","pow","c","log","a","computeBlockReward","newWallClockEpoch","prevWallClockEpoch","newNetworkTimeEpoch","prevNetworkTimeEpoch","mintRate","prevSimpleSupply","E","newSimpleSupply","prevBaselineSupply","getCurrBaseline","e","Comp","currEpoch","nwqap","nwqapP","nwqapV","nwCircSupply","perEpochRewardP","perEpochRewardV","perDurationNwRbGrowth","projectedDays","perDurationMinerQaGrowth","nwCumsumRealized","Object","assign","this","sectorQAP","days","networkQAPFilter","AlphaBetaFilter","perEpochRewardFilter","extrapolateCumsumRatio","projectFutureReward","max","sectorIp","computeInitialPledgeForQAPower","sectorProjectedReward","sectorFaultFee","perEpochNwRbGrowth","perEpochMinerQaGrowth","newInitialPledges","totalInitialPledge","currNetworkQAP","currCumsumRealized","prevNetworkTime","newInitialPledge","push","newNetworkTime","newReward","addNewEntry","p","v","alpha","beta","value","deltaT","residual","numerator","denominator","futureT","x2a","x2b","blockLimit","objectFilter","obj","fn","fromEntries","entries","filter","objectMap","map","i","sizeToString","s","biUnits","unit","length","toFixed","Stats","client","average","fetcher","tipsets","console","fetchHead","head","height","Height","fetchTipsetHead","tipset","keys","transactions","msgs","totalGas","reduce","total","GasUsed","acc","tup","Message","GasLimit","avg","method","parentAndReceiptsMessages","Cids","parseInt","GasFeeCap","div","reduc","tx","allTx","concat","gasUsedMethod","totalUsed","gasLimitMethod","totalLimit","ratios","totalGasLimit","nbBlocks","ratio","totalGasUsed","used","limit","datas","users","tuple","undefined","To","sorted","gas","user","sort","b","slice","miner","allHeights","sortedHeights","getMinerPower","mif","avgGasOfMethod","MinerPower","RawBytePower","nbSectors","size","dailyGas","avgGasFeeCap","maxDailyPrice","raw","TotalPower","atto","d3","require","f","format","b64","bx","BN","schema","testnet","fullNode","b64ToBn","window","BigInt","bin","atob","hex","split","forEach","ch","h","charCodeAt","toString","join","partitionSchema","Sectors","Unproven","Faults","Recoveries","Terminated","ExpirationEpochs","EarlyTerminated","LivePower","UnprovenPower","FaultyPower","RecoveringPower","preCommitSchema","type","key","info","seal_proof","sector_number","sealed_cid","seal_rand_epoch","deal_ids","expiration","replace_capacity","replace_sector_deadline","replace_sector_partition","replace_sector_number","precommit_deposit","precommit_epoch","deal_weight","verified_deal_weight","bytesToBig","bytesToBigRev","mul","add","nextBits","n","res","num","and","shln","sub","shrn","left","toNumber","decodeRLE2","buf","first","x","Error","runs","decodeRLE","cur","r","Filecoin","endpointUrl","url","provider","BrowserProvider","LotusRPC","parents","receipts","minfo","path","state","Blocks","ParentStateRoot","node","chainGetNode","data","Obj","self","Fil","methods","decode","asObject","chainHead","cid","partitionRaw","partitionObj","curr","ChainGetTipSetByHeight","storagePowerActorRaw","TotalRawBytePower","TotalBytesCommitted","TotalQualityAdjPower","TotalQABytesCommitted","TotalPledgeCollateral","ThisEpochRawBytePower","ThisEpochQualityAdjPower","ThisEpochPledgeCollateral","hash","StateReadState","State","Balance","PreCommitDeposits","LockedFunds","InitialPledge","FeeDebt","Available","cached","localStorage","getItem","cachedTime","Date","now","JSON","parse","fetch","json","miners","address","setItem","stringify","deadlinesCids","asyncPool","minerCid","ChainGetNode","deadline","Partitions","LiveSectors","TotalSectors","Raw","Number","deadlines","StateMinerInfo","Promise","all","StateMinerProvingDeadline","fetchDeadlinesProxy","nextDeadlines","Array","_","Index","Close","SectorsCount","d","FaultsCount","ActiveCount","getData","preCommittedSectors","PreCommitDeadlines","groups","SectorNumber","Expiry","Count","StateMinerSectors","sectorList","ID","number","sectorsCount","chainGetParentMessages","chainGetParentReceipts","parentMessages","receiptParentMessages","zip","entry","exit","ExitCode","inMethod","includes","Method","stateMinerPower","m","StateCirculatingSupply","Supply","Reward","Power","inputs","ThisEpochQAPowerSmoothed","PositionEstimate","VelocityEstimate","FilCirculating","ThisEpochRewardSmoothed","CumsumRealized","Economics","summary","arr","arrs","val","Summary","title","desc","className","href","f0","f3","Home","actors","econSummary","computeEconomics","id","to","FilBurnt","FilLocked","ThisEpochReward","MinerAboveMinPowerCount","WindowPoStStatus","round","ceil","f2","Status","spa","useState","minersDeadlines","setMinersDeadlines","minersDeadlines2880","setMinersDeadlines2880","prev60","setPrev60","prev120","setPrev120","useEffect","getPrev","diff","prevHead","fetchPower","prevSpa","fetchingPrevious","mounted","minersList","minerId","fetchDeadlines","deadlines2880","WindowPoSt","link","out","Full","setHead","fetched","fetchingHead","MinerBar","deadlineId","deposits","tag","name","location","flagEmoji","withRouter","useParams","partitions","setPartitions","minerDeadlines","setMinerDeadlines","todayDeadlines","setTodayDeadlines","fetchPartitionsSectors","then","epochs","day","data-tip","data-for","effect","place","flat","partition","sector","setMiner","fetchMinerInfo","catch","error","fetchDeposits","fetchPreCommittedSectors","preCommits","PostSubmissions","FaultCutoff","Challenge","Open","getFilecoinExpectedHeight","filGenesis","getTime","floor","TinySummary","expected","setFilExpectedHeight","setRound","Drand","current","interval","setInterval","clearInterval","GrowthCard","nstats","commits","setCommits","wposts","setWposts","graph","setGraph","canvasRef","useRef","cardRef","setCollapseEvent","g","addEventListener","update","options","display","text","scales","yAxes","position","scaleLabel","labelString","fillDataset","transactionsPerHeight","allSealed","allProven","sealed","proven","newCommits","newWposts","rounds","reverse","filteredCommits","dataCommits","filteredPosts","dataWposts","w","myGraph","dataset","borderColor","chartColors","blue","fill","label","yAxisID","red","lineData","datasets","labels","ctx","getContext","newGraph","Chart","data-toggle","data-target","aria-expanded","aria-controls","ref","aria-labelledby","data-parent","MinerInfoCard","minerAddr","setAddr","setData","searchMiner","preventDefault","minerInfo","for","onChange","target","placeholder","onClick","BiggestGasSpenderCard","setOpts","pie","setPie","biggestGasUserFor","sortedHeight","rawData","backgroundColor","color","newOpts","newDataset","myPie","newPie","GasTableCard","headers","empty","wpost","pre","prove","avgGas","setAvgGas","updateAverage","avgTotalGasUsed","avgGasLimit","computeEntry","avgNumberTx","nTx","gasUsed","gasLimit","avgRatioUsedOverTotalUsed","ratioUsed","avgRatioLimitOverTotalLimit","ratioLimit","avgRatioUsedOverLimit","ratioUsedLimit","avgTotalGasUsedOverTipsetLimit","ratioUsedBlockLimit","avgTotalGasLimitOverTipsetLimit","ratioBlockLimit","results","RowInfo","values","props","idx","isNaN","stats","setStat","updateStats","fetchCids","orange","yellow","green","purple","grey","App","setMiners","setFilClient","setActors","reload","fetchGenesisActors","fetchingEcon","getMiners","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.c26da549.chunk.js","sourcesContent":["const EPOCHS_PER_DAY = (24 * 60 * 60) / 30\nconst EPOCHS_PER_YEAR = 365 * EPOCHS_PER_DAY\nconst INITIAL_BASELINE = 2888888880000000000\nconst BASELINE_ANNUAL_GROWTH = 1\n\nconst computeEffectiveNetworkTime = function (cumsumRealized) {\n  const x0 = INITIAL_BASELINE\n  const annualGrowth = BASELINE_ANNUAL_GROWTH\n  const k = Math.pow(1 + annualGrowth, 1 / EPOCHS_PER_YEAR)\n  const c = 1 / Math.log(k)\n  const a = -x0 * c\n  return Math.log((cumsumRealized - a) / (x0 * c)) / Math.log(k)\n}\n\nconst computeBlockReward = function (\n  newWallClockEpoch,\n  prevWallClockEpoch,\n  newNetworkTimeEpoch,\n  prevNetworkTimeEpoch\n) {\n  const totalSimpleSupply = 330e6\n  const totalBaselineSupply = 770e6\n  const mintRate = Math.log(2) / (6 * EPOCHS_PER_YEAR)\n\n  const prevSimpleSupply =\n    totalSimpleSupply * (1 - Math.pow(Math.E, -mintRate * prevWallClockEpoch))\n  const newSimpleSupply =\n    totalSimpleSupply * (1 - Math.pow(Math.E, -mintRate * newWallClockEpoch))\n\n  const prevBaselineSupply =\n    totalBaselineSupply *\n    (1 - Math.pow(Math.E, -mintRate * prevNetworkTimeEpoch))\n  const newBaselineSupply =\n    totalBaselineSupply *\n    (1 - Math.pow(Math.E, -mintRate * newNetworkTimeEpoch))\n\n  return (\n    newSimpleSupply + newBaselineSupply - prevSimpleSupply - prevBaselineSupply\n  )\n}\n\nconst getCurrBaseline = function (e) {\n  const x0 = INITIAL_BASELINE\n  const annualGrowth = BASELINE_ANNUAL_GROWTH\n  const k = Math.pow(1 + annualGrowth, 1 / EPOCHS_PER_YEAR)\n  return x0 * Math.pow(k, e)\n}\n\nexport default class Comp {\n  constructor ({\n    currEpoch,\n    nwqap,\n    nwqapP,\n    nwqapV,\n    nwCircSupply,\n    perEpochRewardP,\n    perEpochRewardV,\n    perDurationNwRbGrowth,\n    projectedDays,\n    perDurationMinerQaGrowth,\n    nwCumsumRealized\n  }) {\n    Object.assign(this, {\n      currEpoch,\n      nwqap,\n      nwqapP,\n      nwqapV,\n      nwCircSupply,\n      perEpochRewardP,\n      perEpochRewardV,\n      perDurationNwRbGrowth,\n      projectedDays,\n      perDurationMinerQaGrowth,\n      nwCumsumRealized\n    })\n  }\n\n  projectFutureReward (sectorQAP, days) {\n    const networkQAPFilter = new AlphaBetaFilter(this.nwqapP, this.nwqapV)\n    const perEpochRewardFilter = new AlphaBetaFilter(\n      this.perEpochRewardP,\n      this.perEpochRewardV\n    )\n    return (\n      sectorQAP *\n      extrapolateCumsumRatio(\n        perEpochRewardFilter,\n        networkQAPFilter,\n        days * EPOCHS_PER_DAY\n      )\n    )\n  }\n\n  computeInitialPledgeForQAPower (sectorQAP, currEpoch) {\n    return (\n      this.projectFutureReward(sectorQAP, 20) +\n      (sectorQAP * 0.3 * this.nwCircSupply) /\n        Math.max(this.nwqap, getCurrBaseline(currEpoch))\n    )\n  }\n\n  summary () {\n    const sectorIp = this.computeInitialPledgeForQAPower(\n      32 * 2 ** 30,\n      this.currEpoch\n    )\n    const sectorProjectedReward = this.projectFutureReward(32 * 2 ** 30, 360)\n    const sectorFaultFee = this.projectFutureReward(32 * 2 ** 30, 3.51)\n\n    return {\n      sectorIp,\n      sectorProjectedReward,\n      sectorFaultFee\n    }\n  }\n\n  computeInitialPledgeFromAssumptions () {\n    const {\n      currEpoch,\n      nwqap,\n      nwqapP,\n      nwqapV,\n      nwCircSupply,\n      perEpochRewardP,\n      perEpochRewardV,\n      perDurationNwRbGrowth,\n      projectedDays,\n      perDurationMinerQaGrowth,\n      nwCumsumRealized\n    } = this\n\n    const networkQAPFilter = new AlphaBetaFilter(nwqapP, nwqapV)\n    const perEpochRewardFilter = new AlphaBetaFilter(\n      perEpochRewardP,\n      perEpochRewardV\n    )\n    const perEpochNwRbGrowth =\n      perDurationNwRbGrowth / projectedDays / EPOCHS_PER_DAY\n    const perEpochMinerQaGrowth =\n      perDurationMinerQaGrowth / projectedDays / EPOCHS_PER_DAY\n\n    const newInitialPledges = []\n    var totalInitialPledge = 0\n    let currNetworkQAP = nwqap\n    let currCumsumRealized = nwCumsumRealized\n    var prevNetworkTime = computeEffectiveNetworkTime(nwCumsumRealized)\n\n    for (\n      var e = currEpoch + 1;\n      e < currEpoch + projectedDays * EPOCHS_PER_DAY + 1;\n      e++\n    ) {\n      // first compute initial pledge required for this epoch\n      const newInitialPledge =\n        perEpochMinerQaGrowth *\n        (extrapolateCumsumRatio(\n          perEpochRewardFilter,\n          networkQAPFilter,\n          20 * EPOCHS_PER_DAY\n        ) +\n          (0.3 * nwCircSupply) / Math.max(currNetworkQAP, getCurrBaseline(e)))\n      newInitialPledges.push(newInitialPledge)\n      totalInitialPledge += newInitialPledge\n      // then update filter values\n      currNetworkQAP += perEpochNwRbGrowth\n      currCumsumRealized += currNetworkQAP\n      const newNetworkTime = computeEffectiveNetworkTime(currCumsumRealized)\n      const newReward = computeBlockReward(\n        e,\n        e - 1,\n        newNetworkTime,\n        prevNetworkTime\n      )\n      perEpochRewardFilter.addNewEntry(newReward, 1)\n      networkQAPFilter.addNewEntry(currNetworkQAP, 1)\n      prevNetworkTime = newNetworkTime\n    }\n\n    return { newInitialPledges, totalInitialPledge }\n  }\n}\n\nclass AlphaBetaFilter {\n  constructor (p, v) {\n    this.alpha = 9.25e-4\n    this.beta = 2.84e-7\n    this.p = p\n    this.v = v\n  }\n\n  addNewEntry (value, deltaT) {\n    this.p += this.v * deltaT\n    const residual = value - this.p\n    this.p += this.alpha * residual\n    this.p = Math.max(this.p, 0)\n    this.v += (this.beta * residual) / deltaT\n  }\n}\n\nconst extrapolateCumsumRatio = function (numerator, denominator, futureT) {\n  const x2a = Math.log(denominator.p + denominator.v)\n  const x2b = Math.log(denominator.p + denominator.v + denominator.v * futureT)\n  const m1 = denominator.v * numerator.p * (x2b - x2a)\n  const m2 =\n    numerator.v * (denominator.p * (x2a - x2b) + denominator.v * futureT)\n  return (m1 + m2) / Math.pow(denominator.v, 2)\n}\n","const blockLimit = 5 * 10 ** 9\nconst roundsPerDay = 2 * 60 * 24\nconst roundsInDeadline = 2 * 30\nconst deadlines = 48\nconst maxSectorsPerPost = 2349\nexport function wpostToSectors (wpost) {\n  return maxSectorsPerPost * wpost\n}\n\nfunction gbToPB (v) {\n  return v / 1024 / 1024\n}\nfunction pbToGB (v) {\n  return v * 1024 * 1024\n}\n// Returns the estimated growthRate per day assuming this number of prove\n// commits at one height (or an average etc)\nexport function growthRate (prove) {\n  return gbToPB(prove * 32) * roundsPerDay\n}\n\nexport function objectFilter (obj, fn) {\n  return Object.fromEntries(Object.entries(obj).filter(([k, v]) => fn(v, k)))\n}\n\nexport function objectMap (obj, fn) {\n  return Object.entries(obj).map(([k, v], i) => fn(v, k, i))\n}\n\nfunction roundsInDays (rounds) {\n  return Math.ceil(rounds / 2 / 60 / 24)\n}\n\nfunction sectorsToPost (sectors) {\n  return sectors / maxSectorsPerPost\n}\n\nfunction sizeToString (s) {\n  var biUnits = ['B', 'KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB']\n  var unit = 0\n  while (s >= 1024 && unit < biUnits.length - 1) {\n    s /= 1024\n    unit++\n  }\n  s = s.toFixed(2)\n  return `${s} ${biUnits[unit]}`\n}\n\nfunction sizeToSectors (s) {\n  return s / 1024 / 1024 / 1024 / 32\n}\n\nfunction attoToFIL (atto) {\n  return atto * 10 ** -18\n}\n\nexport default class Stats {\n  constructor (client, average) {\n    this.fetcher = client\n    this.average = average\n    this.tipsets = {}\n  }\n\n  // XXX Make head a paramter and fethc only what it needs\n  async fetchCids () {\n    // at the moment take the first block - this is ok since parent tipset\n    // is the same for all the blocks\n    console.log('Initializing gas stats engine')\n    const head = await this.fetcher.fetchHead()\n    const height = head.Height\n    this.tipsets[head.Height] = head\n    for (var i = 1; i < this.average; i++) {\n      const tipset = await this.fetcher.fetchTipsetHead(height - i)\n      this.tipsets[tipset.Height] = tipset\n      console.log(\n        i,\n        '/',\n        this.average,\n        ': init fetched tipset at height ',\n        tipset.Height,\n        ' with [0] = ',\n        tipset\n      )\n    }\n    console.log(\n      'Stats: got ' +\n        Object.keys(this.tipsets).length +\n        ' tipset CIDs to make stats from'\n    )\n  }\n\n  // returns the average gas used of a given method\n  async avgGasOfMethod (...method) {\n    const msgs = await this.transactions(...method)\n    const totalGas = msgs.reduce((total, v) => total + v[1].GasUsed, 0)\n    return totalGas / msgs.length\n  }\n\n  // Return the average of the gas limit PER height\n  async avgGasLimit (...method) {\n    return (await this.transactions(...method)).reduce(\n      (acc, tup) => acc + tup[0].Message.GasLimit,\n      0\n    )\n  }\n\n  async avgGasFeeCap (...method) {\n    var avg = 0\n    for (var height in this.tipsets) {\n      const tipset = this.tipsets[height]\n      const msgs = await this.fetcher.parentAndReceiptsMessages(\n        tipset.Cids[0],\n        ...method\n      )\n      avg +=\n        msgs.reduce((total, v) => total + parseInt(v[0].Message.GasFeeCap), 0) /\n        msgs.length\n    }\n    return avg / Object.keys(this.tipsets).length\n  }\n\n  // Returns the average of the total gas used PER height\n  async avgTotalGasUsed (...method) {\n    const div = Object.keys(this.tipsets).length\n    const reduc = (await this.transactions(...method)).reduce(\n      (total, tup) => total + tup[1].GasUsed,\n      0\n    )\n    return reduc / div\n  }\n\n  async avgNumberTx (...method) {\n    const tx = await this.transactions(...method)\n    return tx.length / Object.keys(this.tipsets).length\n  }\n\n  async transactions (...method) {\n    var allTx = []\n    for (var height in this.tipsets) {\n      const tipset = this.tipsets[height]\n      const msgs = await this.fetcher.parentAndReceiptsMessages(\n        tipset.Cids[0],\n        ...method\n      )\n      allTx = allTx.concat(msgs)\n    }\n    return allTx\n  }\n\n  async transactionsPerHeight (...method) {\n    const allTx = {}\n    for (var height in this.tipsets) {\n      const tipset = this.tipsets[height]\n      const msgs = await this.fetcher.parentAndReceiptsMessages(\n        tipset.Cids[0],\n        ...method\n      )\n      allTx[height] = msgs\n    }\n    return allTx\n  }\n\n  async avgRatioUsedOverTotalUsed (...method) {\n    const gasUsedMethod = (await this.transactions(...method)).reduce(\n      (acc, v) => acc + v[1].GasUsed,\n      0\n    )\n    const totalUsed = (await this.transactions()).reduce(\n      (acc, v) => acc + v[1].GasUsed,\n      0\n    )\n    return gasUsedMethod / totalUsed\n  }\n\n  async avgRatioLimitOverTotalLimit (...method) {\n    const gasLimitMethod = (await this.transactions(...method)).reduce(\n      (acc, v) => acc + v[0].Message.GasLimit,\n      0\n    )\n    const totalLimit = (await this.transactions()).reduce(\n      (acc, v) => acc + v[0].Message.GasLimit,\n      0\n    )\n    return gasLimitMethod / totalLimit\n  }\n\n  // return the avg total gas limit set per height for the given method over\n  // the maximal theoretical gas limit\n  async avgTotalGasLimitOverTipsetLimit (...method) {\n    var ratios = []\n    for (var height in this.tipsets) {\n      const tipset = this.tipsets[height]\n      const msgs = await this.fetcher.parentAndReceiptsMessages(\n        tipset.Cids[0],\n        ...method\n      )\n      const totalGasLimit = msgs.reduce(\n        (total, tup) => total + tup[0].Message.GasLimit,\n        0\n      )\n      const nbBlocks = tipset.Cids.length\n      const ratio = totalGasLimit / (blockLimit * nbBlocks)\n      ratios.push(ratio)\n    }\n    // make the average\n    return ratios.reduce((acc, v) => acc + v, 0) / ratios.length\n  }\n\n  async avgTotalGasUsedOverTipsetLimit (...method) {\n    var ratios = []\n    for (var height in this.tipsets) {\n      const tipset = this.tipsets[height]\n      const msgs = await this.fetcher.parentAndReceiptsMessages(\n        tipset.Cids[0],\n        ...method\n      )\n      const totalGasUsed = msgs.reduce(\n        (total, tup) => total + tup[1].GasUsed,\n        0\n      )\n      const nbBlocks = tipset.Cids.length\n      const ratio = totalGasUsed / (blockLimit * nbBlocks)\n      ratios.push(ratio)\n    }\n    // make the average\n    return ratios.reduce((acc, v) => acc + v, 0) / ratios.length\n  }\n\n  async avgRatioUsedOverLimit (...method) {\n    const used = (await this.transactions(...method)).reduce(\n      (acc, v) => acc + v[1].GasUsed,\n      0\n    )\n    const limit = (await this.transactions(...method)).reduce(\n      (acc, v) => acc + v[0].Message.GasLimit,\n      0\n    )\n    return used / limit\n  }\n\n  async biggestGasUserFor (...methods) {\n    var datas = {}\n    for (var height in this.tipsets) {\n      const msgs = await this.transactions(...methods)\n      var users = msgs.reduce((acc, tuple) => {\n        if (acc[tuple[0].Message.To] == undefined) {\n          acc[tuple[0].Message.To] = 0\n        }\n        acc[tuple[0].Message.To] += tuple[1].GasUsed\n        return acc\n      }, {})\n      // combinatio of mapping over dict\n      // https://stackoverflow.com/questions/14810506/map-function-for-objects-instead-of-arrays\n      // and sorting in decreasing order\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort\n      const sorted = objectMap(users, (gas, user) => [user, gas]).sort(\n        (a, b) => b[1] - a[1]\n      )\n      datas[height] = sorted\n      console.log('Biggest txs at height', height, ' -> ', sorted.slice(0, 10))\n    }\n    return datas\n  }\n\n  sortedHeights () {\n    return Object.keys(this.tipsets).sort((a, b) => b - a)\n  }\n\n  async minerInfo (miner) {\n    const allHeights = this.sortedHeights()\n    const tipset = this.tipsets[allHeights[0]]\n    const mif = await this.fetcher.getMinerPower(\n      tipset.Cids,\n      tipset.Height,\n      miner\n    )\n    const gas = await this.avgGasOfMethod(5)\n    const nbSectors = sizeToSectors(mif.MinerPower.RawBytePower)\n    const size = sizeToString(mif.MinerPower.RawBytePower)\n    const dailyGas = sectorsToPost(nbSectors) * gas\n    const maxDailyPrice = dailyGas * (await this.avgGasFeeCap(5))\n    return {\n      raw: mif.MinerPower.RawBytePower,\n      ratio: (\n        mif.MinerPower.RawBytePower / mif.TotalPower.RawBytePower\n      ).toFixed(3),\n      size: size,\n      dailyGas: dailyGas.toFixed(2),\n      maxDailyPrice: attoToFIL(maxDailyPrice).toFixed(2)\n    }\n  }\n}\n","import { LotusRPC } from '@filecoin-shipyard/lotus-client-rpc'\nimport { BrowserProvider } from '@filecoin-shipyard/lotus-client-provider-browser'\nimport Fil from 'js-hamt-filecoin'\nimport Economics from './economics'\nimport Stats from './stats'\nimport { partition } from 'd3'\nimport asyncPool from 'tiny-async-pool'\nconst d3 = require('d3')\nconst f = d3.format('0.2f')\nconst bx = require('base-x')\nconst BASE64 =\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nconst b64 = bx(BASE64)\nconst BN = require('bn.js')\n\nconst schema = require('@filecoin-shipyard/lotus-client-schema').testnet\n  .fullNode\n\nfunction b64ToBn (b64) {\n  if (b64 === '') return window.BigInt(0)\n  var bin = atob(b64)\n  var hex = []\n\n  bin.split('').forEach(function (ch) {\n    var h = ch.charCodeAt(0).toString(16)\n    if (h.length % 2) {\n      h = '0' + h\n    }\n    hex.push(h)\n  })\n\n  return window.BigInt('0x' + hex.join(''))\n}\n\nconst partitionSchema = height => {\n  console.log('>>>> HEIGHT', height)\n  if (!height || height >= 138720) {\n    return {\n      Sectors: 'buffer',\n      Unproven: 'buffer',\n      Faults: 'buffer',\n      Recoveries: 'buffer',\n      Terminated: 'buffer',\n      ExpirationEpochs: 'cid',\n      EarlyTerminated: 'cid',\n      LivePower: {\n        a: 'bigint',\n        b: 'bigint'\n      },\n      UnprovenPower: {\n        a: 'bigint',\n        b: 'bigint'\n      },\n      FaultyPower: {\n        a: 'bigint',\n        b: 'bigint'\n      },\n      RecoveringPower: {\n        a: 'bigint',\n        b: 'bigint'\n      }\n    }\n  }\n  return {\n    Sectors: 'buffer',\n    Faults: 'buffer',\n    Recoveries: 'buffer',\n    Terminated: 'buffer',\n    ExpirationEpochs: 'cid',\n    EarlyTerminated: 'cid',\n    LivePower: {\n      a: 'bigint',\n      b: 'bigint'\n    },\n    FaultyPower: {\n      a: 'bigint',\n      b: 'bigint'\n    },\n    RecoveringPower: {\n      a: 'bigint',\n      b: 'bigint'\n    }\n  }\n}\n\nconst preCommitSchema = {\n  type: 'hamt',\n  key: 'bigint',\n  value: {\n    info: {\n      seal_proof: 'int',\n      sector_number: 'int',\n      sealed_cid: 'cid',\n      seal_rand_epoch: 'int',\n      deal_ids: ['list', 'int'],\n      expiration: 'int',\n      replace_capacity: 'bool',\n      replace_sector_deadline: 'int',\n      replace_sector_partition: 'int',\n      replace_sector_number: 'int'\n    },\n    precommit_deposit: 'bigint',\n    precommit_epoch: 'int',\n    deal_weight: 'bigint',\n    verified_deal_weight: 'bigint'\n  }\n}\n\nfunction bytesToBig (p) {\n  let acc = 0n\n  for (let i = 0; i < p.length; i++) {\n    acc *= 256n\n    acc += window.BigInt(p[i])\n  }\n  return acc\n}\n\nfunction bytesToBigRev (p) {\n  let acc = new BN(0)\n  for (let i = 0; i < p.length; i++) {\n    acc = acc.mul(new BN(256))\n    acc = acc.add(new BN(p[p.length - i - 1]))\n  }\n  return acc\n}\n\nfunction nextBits (obj, n) {\n  // if (obj.left < n) throw new Error(\"out of bits\")\n  const res = obj.num.and(new BN(1).shln(n).sub(new BN(1)))\n  obj.num = obj.num.shrn(n)\n  obj.left -= n\n  return res.toNumber()\n}\n\nfunction decodeRLE (buf) {\n  const obj = {\n    left: 8 * buf.length,\n    num: bytesToBigRev(buf)\n  }\n  const version = nextBits(obj, 2)\n  const first = nextBits(obj, 1)\n  const res = []\n  while (obj.left > 0) {\n    let b1 = nextBits(obj, 1)\n    if (b1 === 1) {\n      res.push(1)\n      continue\n    }\n    let b2 = nextBits(obj, 1)\n    if (b2 === 1) {\n      const a = nextBits(obj, 4)\n      res.push(a)\n      continue\n    }\n    let x = 0\n    let s = 0\n    for (let i = 0; true; i++) {\n      if (i === 10) {\n        throw new Error('run too long')\n      }\n      let b = nextBits(obj, 8)\n      if (b < 0x80) {\n        if (i > 9 || (i === 9 && b > 1)) {\n          throw new Error('run too long')\n        } else if (b === 0 && s > 0) {\n          throw new Error('invalid run')\n        }\n        x |= b << s\n        break\n      }\n      x |= (b & 0x7f) << s\n      s += 7\n    }\n    res.push(x)\n  }\n  return { first, runs: res }\n}\n\nfunction decodeRLE2 (buf) {\n  const { first, runs } = decodeRLE(buf)\n  let cur = first\n  const res = []\n  let acc = 0\n  for (let r of runs) {\n    for (let i = 0; i < r; i++) {\n      if (cur === 1) res.push(acc)\n      acc++\n    }\n    cur = 1 - cur\n  }\n  return res\n}\n\nexport default class Filecoin {\n  constructor (endpointUrl) {\n    this.url = endpointUrl\n    const provider = new BrowserProvider(endpointUrl)\n    console.log('new endpoint', endpointUrl)\n    this.client = new LotusRPC(provider, { schema })\n    this.parents = {}\n    this.receipts = {}\n    this.minfo = {}\n  }\n\n  async getData (head, path, schema) {\n    const state = head.Blocks[0].ParentStateRoot['/']\n    const node =\n      head.Height >= 138720 ? `${state}/1/${path}` : `${state}/${path}`\n    const data = (await this.client.chainGetNode(node)).Obj\n\n    const self = this\n    return await Fil.methods.decode(schema, data).asObject(async a => {\n      const res = await self.client.chainGetNode(a)\n      return res.Obj\n    })\n  }\n\n  async fetchHead () {\n    return this.client.chainHead()\n  }\n\n  async fetchPartitionsSectors (cid, height) {\n    const node = (await this.client.chainGetNode(`${cid['/']}`)).Obj[2][2]\n    return node.map(partitionRaw => {\n      const partitionObj = Fil.methods.decode(\n        partitionSchema(height),\n        partitionRaw\n      )\n      return [\n        {\n          Sectors: decodeRLE2(partitionObj.Sectors),\n          Faults: decodeRLE2(partitionObj.Faults).reduce((acc, curr) => {\n            acc[curr] = true\n            return acc\n          }, {}),\n          Terminated: decodeRLE2(partitionObj.Terminated).reduce(\n            (acc, curr) => {\n              acc[curr] = true\n              return acc\n            },\n            {}\n          ),\n          Recoveries: decodeRLE2(partitionObj.Recoveries).reduce(\n            (acc, curr) => {\n              acc[curr] = true\n              return acc\n            },\n            {}\n          )\n        }\n      ]\n    })\n  }\n\n  async fetchTipsetHead (height) {\n    return await this.client.ChainGetTipSetByHeight(height, null)\n  }\n\n  async fetchPower (head) {\n    const state = head.Blocks[0].ParentStateRoot['/']\n    const node =\n      head.Height >= 138720 ? `${state}/1/@Ha:t04/1` : `${state}/@Ha:t04/1`\n    const storagePowerActorRaw = (await this.client.chainGetNode(node)).Obj\n    return {\n      TotalRawBytePower: bytesToBig(b64.decode(storagePowerActorRaw[0])),\n      TotalBytesCommitted: bytesToBig(b64.decode(storagePowerActorRaw[1])),\n      TotalQualityAdjPower: bytesToBig(b64.decode(storagePowerActorRaw[2])),\n      TotalQABytesCommitted: bytesToBig(b64.decode(storagePowerActorRaw[3])),\n      TotalPledgeCollateral: bytesToBig(b64.decode(storagePowerActorRaw[4])),\n      ThisEpochRawBytePower: bytesToBig(b64.decode(storagePowerActorRaw[5])),\n      ThisEpochQualityAdjPower: bytesToBig(b64.decode(storagePowerActorRaw[6])),\n      ThisEpochPledgeCollateral: bytesToBig(b64.decode(storagePowerActorRaw[7]))\n    }\n  }\n\n  async fetchDeposits (hash, head) {\n    const state = await this.client.StateReadState(hash, head.Cids)\n    const { State, Balance } = state\n    const { PreCommitDeposits, LockedFunds, InitialPledge, FeeDebt } = State\n    const Available = Balance - InitialPledge - PreCommitDeposits - LockedFunds\n\n    return {\n      Balance: f(Balance / 1000000000000000000),\n      InitialPledge: f(InitialPledge / 1000000000000000000),\n      Available: f(Available / 1000000000000000000),\n      LockedFunds: f(LockedFunds / 1000000000000000000),\n      PreCommitDeposits: f(PreCommitDeposits / 1000000000000000000),\n      FeeDebt: f(FeeDebt / 1000000000000000000)\n    }\n  }\n\n  async getMiners () {\n    const cached = window.localStorage.getItem('miners')\n    const cachedTime = window.localStorage.getItem('time')\n    if (cached && cachedTime && Date.now() - +cachedTime > 60000)\n      return JSON.parse(cached)\n\n    const json = await (\n      await fetch('https://filfox.info/api/v0/miner/list/power?pageSize=1000')\n    ).json()\n    const miners = json.miners.reduce((acc, curr) => {\n      acc[curr.address] = curr\n      return acc\n    }, {})\n\n    window.localStorage.setItem('miners', JSON.stringify(miners))\n    window.localStorage.setItem('time', Date.now())\n\n    return miners\n  }\n\n  async fetchDeadlinesProxy (miner, head) {\n    const state = head.Blocks[0].ParentStateRoot['/']\n    const node =\n      head.Height >= 138720\n        ? `${state}/1/@Ha:${miner}/1/12`\n        : `${state}/@Ha:${miner}/1/11`\n    const deadlinesCids = (await this.client.chainGetNode(node)).Obj[0]\n\n    const deadlines = await asyncPool(24, deadlinesCids, async minerCid => {\n      const deadline = (await this.client.ChainGetNode(`${minerCid['/']}`)).Obj\n      return {\n        Partitions: deadline[0],\n        LiveSectors: deadline[4],\n        TotalSectors: deadline[5],\n        FaultyPower: { Raw: Number(b64ToBn(deadline[6][0])) }\n      }\n    })\n    return deadlines\n  }\n\n  async fetchMinerInfo (hash, head) {\n    return this.client.StateMinerInfo(hash, head.Cids)\n  }\n\n  async fetchDeadlines (hash, head) {\n    const [deadline, deadlines] = await Promise.all([\n      this.client.StateMinerProvingDeadline(hash, head.Cids),\n      this.fetchDeadlinesProxy(hash, head)\n    ])\n    console.log('>>> got deadline and deadline')\n\n    const nextDeadlines = [...Array(48)].map((_, i) => ({\n      ...deadlines[(deadline.Index + i) % 48],\n      Close: deadline.Close + i * 60,\n      Index: (deadline.Index + i) % 48\n    }))\n\n    const SectorsCount = deadlines\n      .map(d => +d.LiveSectors)\n      .reduce((acc, curr) => acc + curr, 0)\n\n    const FaultsCount =\n      deadlines\n        .map(d => +d.FaultyPower.Raw)\n        .reduce((acc, curr) => acc + curr, 0) /\n      (32 * 1024 * 1024 * 1024)\n\n    return {\n      deadlines: deadlines.map((d, i) => ({\n        ...deadlines[i],\n        Close: deadline.Close + i * 60,\n        Index: i\n      })),\n      nextDeadlines,\n      SectorsCount,\n      FaultsCount,\n      ActiveCount: SectorsCount - FaultsCount,\n      deadline\n    }\n  }\n\n  async fetchPreCommittedSectors (hash, head) {\n    const node = head.Height >= 138720 ? `@Ha:${hash}/1/6` : `@Ha:${hash}/1/5`\n    const preCommittedSectors = await this.getData(head, node, preCommitSchema)\n    const PreCommitDeadlines = d3\n      .groups(\n        Object.keys(preCommittedSectors).map(d => ({\n          SectorNumber: preCommittedSectors[d].info.sector_number,\n          Expiry: preCommittedSectors[d].precommit_epoch + (10000 + 60 + 150)\n        })),\n        d => d.Expiry\n      )\n      .map(([Expiry, Sectors]) => ({\n        Expiry,\n        Sectors: Sectors.map(d => d.SectorNumber)\n      }))\n      .sort((a, b) => a.Expiry - b.Expiry)\n\n    return {\n      PreCommitDeadlines,\n      Count: Object.keys(preCommittedSectors).length\n    }\n  }\n\n  async fetchSectors (hash, head) {\n    const sectorList = await this.client.StateMinerSectors(\n      hash,\n      null,\n      head.Cids\n    )\n    const Sectors = sectorList.reduce((acc, curr) => {\n      acc[curr.ID] = { number: curr.ID, info: curr }\n      return acc\n    }, {})\n\n    const sectorsCount = Object.keys(Sectors).length\n    return { sectorsCount, Sectors }\n  }\n\n  async parentMessages (cid) {\n    if (cid['/'] in this.parents) {\n      return this.parents[cid['/']]\n    }\n    const msgs = await this.client.chainGetParentMessages(cid)\n    this.parents[cid['/']] = msgs\n    return msgs\n  }\n\n  async receiptParentMessages (cid) {\n    if (cid['/'] in this.receipts) {\n      return this.receipts[cid['/']]\n    }\n    const r = await this.client.chainGetParentReceipts(cid)\n    this.receipts[cid['/']] = r\n    return r\n  }\n\n  async parentAndReceiptsMessages (cid, ...methods) {\n    const msgs = await this.parentMessages(cid)\n    const receipts = await this.receiptParentMessages(cid)\n    if (msgs.length != receipts.length) {\n      throw new Error('invalid length')\n    }\n    return zip(msgs, receipts).filter(entry => {\n      const [tx, r] = entry\n      const exit = r.ExitCode == 0\n      var inMethod = true\n      if (methods.length > 0) {\n        inMethod = methods.includes(tx.Message.Method)\n      }\n      return exit && inMethod\n    })\n  }\n\n  async getMinerPower (tipset, height, miner) {\n    if (tipset['/'] in this.minfo) {\n      return this.minfo[tipset['/']]\n    }\n    //let m = await this.client.minerGetBaseInfo(miner,height,tipset)\n    let m = await this.client.stateMinerPower(miner, tipset)\n    this.minfo[tipset['/']] = m\n    return m\n  }\n\n  async fetchGenesisActors (head) {\n    const [Supply, Reward, Power] = await Promise.all([\n      this.client.StateCirculatingSupply(head.Cids),\n      this.client.StateReadState('f02', head.Cids),\n      this.client.StateReadState('f04', head.Cids)\n    ])\n\n    return { Supply, Reward, Power }\n  }\n\n  computeEconomics (\n    head,\n    { Supply, Reward, Power },\n    {\n      projectedDays,\n      perDurationNwRbGrowth = 10 * 2 ** 50,\n      perDurationMinerQaGrowth = 2 ** 51\n    }\n  ) {\n    const inputs = {\n      currEpoch: +head.Height,\n      nwqap: +Power.State.ThisEpochQualityAdjPower,\n      nwqapP: +Power.State.ThisEpochQAPowerSmoothed.PositionEstimate / 2 ** 128,\n      nwqapV: +Power.State.ThisEpochQAPowerSmoothed.VelocityEstimate / 2 ** 128,\n      nwCircSupply: +Supply.FilCirculating / 1e18,\n      perEpochRewardP:\n        +Reward.State.ThisEpochRewardSmoothed.PositionEstimate /\n        (2 ** 128 * 1e18),\n      perEpochRewardV:\n        +Reward.State.ThisEpochRewardSmoothed.VelocityEstimate /\n        (2 ** 128 * 1e18),\n      nwCumsumRealized: +Reward.State.CumsumRealized,\n      perDurationNwRbGrowth,\n      projectedDays,\n      perDurationMinerQaGrowth\n    }\n\n    const econ = new Economics(inputs)\n\n    return econ.summary()\n  }\n}\n\nconst zip = (arr, ...arrs) => {\n  return arr.map((val, i) => arrs.reduce((a, arr) => [...a, arr[i]], [val]))\n}\n","import React from 'react'\n\nexport default function Summary ({ title, url, desc }) {\n  return (\n    <div className='summary col-sm'>\n      <div className='summary-title'>\n        {url ? <a href={url}>{title}</a> : <>{title}</>}\n      </div>\n      <div className='summary-desc'>{desc}</div>\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { Link } from 'react-router-dom'\nimport Summary from '../components/Summary'\n\nconst d3 = require('d3')\nconst f = d3.format(',')\nconst f0 = d3.format(',.0f')\nconst f3 = d3.format(',.3f')\n\nexport default function Home ({ miners, client, actors, head }) {\n  const econSummary =\n    actors &&\n    client.computeEconomics(head, actors, {\n      projectedDays: 1\n    })\n\n  const WindowPoStGasAvg = 534297287\n  const PreCommitGasAvg = 21701073\n  const ProveCommitGasAvg = 47835932\n\n  return (\n    <section id='home' className='container'>\n      <div className='spacerace'>\n        <h3>Top miners</h3>\n        {miners &&\n          Object.keys(miners)\n            .slice(0, 5)\n            .map((d, i) => (\n              <div key={i}>\n                {i + 1}.{' '}\n                <Link to={`/miners/${miners[d].address}`}>\n                  {miners[d].address}\n                </Link>\n              </div>\n            ))}\n        <div>\n          See deadlines of <Link to='/full'>top 50 miners</Link> or click on\n          individual miners or the <Link to='/status'>network status</Link>.\n        </div>\n      </div>\n      {actors && (\n        <div id='actors' className='section'>\n          <h3>Tokens</h3>\n          <div className='grid'>\n            <Summary\n              title={`${f0(+actors.Supply.FilCirculating / 1e18 || 0)} FIL`}\n              desc='Circulating Supply'\n            />\n            <Summary\n              title={`${f0(+actors.Supply.FilBurnt / 1e18 || 0)} FIL`}\n              desc='Burnt'\n            />\n            <Summary\n              desc='Locked'\n              title={`${f0(+actors.Supply.FilLocked / 1e18 || 0)} FIL`}\n            />\n          </div>\n        </div>\n      )}\n      {actors && (\n        <div id='actors2' className='section'>\n          <h3>Power</h3>\n          <div className='grid'>\n            <Summary\n              title={`${f0(\n                +actors.Power.State.TotalBytesCommitted / 2 ** 50 || 0\n              )} PiB`}\n              desc='Network Raw'\n            />\n            <Summary\n              title={`${f3(\n                +actors.Reward.State.ThisEpochReward / 5 / 1e18 || 0\n              )} FIL`}\n              desc='Block Reward'\n            />\n            <Summary\n              desc='Active Miners'\n              title={`${f0(+actors.Power.State.MinerAboveMinPowerCount || 0)}`}\n            />\n          </div>\n        </div>\n      )}\n      {econSummary && (\n        <div id='economics' className='section'>\n          <h3>Economics</h3>\n          <div className='grid'>\n            {econSummary && (\n              <Summary\n                title={`${f3(econSummary.sectorIp || 0)} FIL`}\n                desc='Sector Pledge'\n              />\n            )}\n\n            {econSummary && (\n              <Summary\n                title={`${f3(econSummary.sectorProjectedReward || 0)} FIL`}\n                desc='Sector 180-Days Reward'\n              />\n            )}\n\n            {econSummary && (\n              <Summary\n                desc='Sector Fault Fee'\n                title={`${f3(econSummary.sectorFaultFee || 0)} FIL`}\n              />\n            )}\n          </div>\n          These numbers are approximate projections based on the current network\n          state and may be incorrect, do your own research.\n        </div>\n      )}\n      <div className='section'>\n        <h3>Gas</h3>\n        See <Link to='/gas'> here </Link> for a detailed gas analysis.\n      </div>\n    </section>\n  )\n}\n","import React from 'react'\n\nexport default function WindowPoStStatus ({ deadline, head }) {\n  const d = deadline\n\n  return (\n    <div className='deadlines windowpost'>\n      <div className={d.LiveSectors === 0 ? 'deadline opacity5' : 'deadline'}>\n        <div className='out'>\n          In {d.Close - head.Height}\n          {/* <span className=\"epochs\">epochs</span> */}\n        </div>\n        <div className='hddWrapper'>\n          <div className='in'>\n            {Math.round((d.LiveSectors * 32) / 1024)} TiB\n          </div>\n          <div className='hdds'>\n            {[\n              ...Array(\n                Math.ceil(\n                  Math.round(\n                    (d.LiveSectors * 32) / 1024 -\n                      +d.FaultyPower.Raw / (1024 * 1024 * 1024 * 1024)\n                  ) / 8\n                )\n              )\n            ].map((v, i) => (\n              <div key={i} className='hdd'>\n                {' '}\n              </div>\n            ))}\n            {[\n              ...Array(\n                Math.ceil(\n                  Math.round(+d.FaultyPower.Raw / (1024 * 1024 * 1024 * 1024)) /\n                    8\n                )\n              )\n            ].map((v, i) => (\n              <div key={i} className='hdd faulty'>\n                {' '}\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport asyncPool from 'tiny-async-pool'\nimport { Link } from 'react-router-dom'\nimport Summary from '../components/Summary'\nimport WindowPoStStatus from '../components/WindowPoStStatus'\n\nconst d3 = require('d3')\nconst f2 = d3.format(',.2f')\nconst bytesToPiB = 1024 * 1024 * 1024 * 1024 * 1024\n\nexport default function Status ({ client, spa, head, miners }) {\n  const [minersDeadlines, setMinersDeadlines] = useState({})\n  const [minersDeadlines2880, setMinersDeadlines2880] = useState({})\n  const [prev60, setPrev60] = useState()\n  const [prev120, setPrev120] = useState()\n\n  useEffect(() => {\n    if (!head) return\n\n    const fetchingPrevious = async () => {\n      const getPrev = async diff => {\n        const prevHead = await client.fetchTipsetHead(head.Height - diff)\n        const prevSpa = await client.fetchPower(prevHead)\n        return prevSpa\n      }\n\n      const [prev60, prev120] = await Promise.all([getPrev(60), getPrev(120)])\n\n      await setPrev60(prev60)\n      await setPrev120(prev120)\n    }\n    fetchingPrevious()\n  }, [head])\n\n  useEffect(() => {\n    let mounted = true\n    if (!head) return\n\n    const minersList = Object.keys(miners)\n      .slice(0, 40)\n      .map(d => miners[d].address)\n    asyncPool(5, minersList, async minerId => {\n      if (!mounted) return\n      const deadlines = await client.fetchDeadlines(minerId, head)\n      if (!mounted) return\n      const prevHead = await client.fetchTipsetHead(head.Height - 2880)\n      if (!mounted) return\n      const deadlines2880 = await client.fetchDeadlines(minerId, prevHead)\n      if (!mounted) return\n      minersDeadlines[minerId] = deadlines\n      minersDeadlines2880[minerId] = deadlines2880\n      await setMinersDeadlines({ ...minersDeadlines })\n      return await setMinersDeadlines2880({ ...minersDeadlines2880 })\n    })\n\n    return () => {\n      mounted = false\n    }\n  }, [client, head, miners])\n\n  return (\n    <section className='container'>\n      <div id='deposits' className='section'>\n        <div className='grid'>\n          {spa && (\n            <>\n              <Summary\n                title={f2(parseInt(spa.TotalQualityAdjPower) / bytesToPiB)}\n                desc='Total QA Power'\n              />\n            </>\n          )}\n          {prev60 && spa && (\n            <>\n              <Summary\n                title={f2(\n                  parseInt(\n                    spa.TotalQualityAdjPower - prev60.TotalQualityAdjPower\n                  ) / bytesToPiB\n                )}\n                desc='60 Epochs delta'\n              />\n            </>\n          )}\n          {prev120 && spa && (\n            <>\n              <Summary\n                title={f2(\n                  parseInt(\n                    spa.TotalQualityAdjPower - prev120.TotalQualityAdjPower\n                  ) / bytesToPiB\n                )}\n                desc='120 Epochs delta'\n              />\n            </>\n          )}\n        </div>\n      </div>\n      Listing WindowPoSt duties of the top 50 miners.\n      {miners &&\n        Object.keys(miners)\n          .slice(0, 40)\n          .map((d, i) => (\n            <div className='flex' key={i}>\n              <Link to={`/miners/${miners[d].address}`}>\n                {miners[d].address}\n              </Link>\n              {minersDeadlines && minersDeadlines[miners[d].address] && (\n                <WindowPoStStatus\n                  head={head}\n                  deadline={\n                    minersDeadlines[miners[d].address].nextDeadlines[47]\n                  }\n                />\n              )}\n              {minersDeadlines2880 &&\n                minersDeadlines2880[miners[d].address] && (\n                  <WindowPoStStatus\n                    head={head}\n                    deadline={\n                      minersDeadlines2880[miners[d].address].nextDeadlines[47]\n                    }\n                  />\n                )}\n            </div>\n          ))}\n    </section>\n  )\n}\n","import React from 'react'\nimport { Link } from 'react-router-dom'\n\nexport default function WindowPoSt ({ minerId, deadlines, head, link, out }) {\n  if (!link) {\n    link = d => `/miners/${minerId}/deadlines/${d.Index}`\n  }\n  if (!out) {\n    out = ({ d, head, i }) => `In ${d.Close - head.Height}`\n  }\n  if (!head || !deadlines) {\n    return <></>\n  }\n  return (\n    <div className='deadlines windowpost'>\n      {deadlines &&\n        deadlines.map((d, i) => (\n          <div\n            key={i}\n            className={d.LiveSectors === 0 ? 'deadline opacity5' : 'deadline'}\n          >\n            <Link to={link(d)}>\n              <div className='out'>\n                {out({ d, head, i })}\n                {/* <span className=\"epochs\">epochs</span> */}\n              </div>\n              <div className='hddWrapper'>\n                <div className='in'>\n                  {Math.round((d.LiveSectors * 32) / 1024)} TiB\n                </div>\n                <div className='hdds'>\n                  {[\n                    ...Array(\n                      Math.ceil(\n                        Math.round(\n                          (d.LiveSectors * 32) / 1024 -\n                            +d.FaultyPower.Raw / (1024 * 1024 * 1024 * 1024)\n                        ) / 8\n                      )\n                    )\n                  ].map((v, i) => (\n                    <div key={i} className='hdd'>\n                      {' '}\n                    </div>\n                  ))}\n                  {/* {Math.round(+d.FaultyPower.Raw / (1024 * 1024 * 1024 * 1024))} */}\n                  {[\n                    ...Array(\n                      Math.ceil(\n                        Math.round(\n                          +d.FaultyPower.Raw / (1024 * 1024 * 1024 * 1024)\n                        ) / 8\n                      )\n                    )\n                  ].map((v, i) => (\n                    <div key={i} className='hdd faulty'>\n                      {' '}\n                    </div>\n                  ))}\n                </div>\n              </div>\n              {/* <div className=\"partitions\">\n                            {\n                            [...Array(Math.ceil(d.LiveSectors/2349))].map(v =>\n                            <div className='partition'></div>\n                            )\n                            }\n                            </div> */}\n            </Link>\n          </div>\n        ))}\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { Link } from 'react-router-dom'\nimport asyncPool from 'tiny-async-pool'\n\nimport WindowPoSt from '../components/WindowPoSt'\n\nexport default function Full ({ miners, client }) {\n  const [minersDeadlines, setMinersDeadlines] = useState({})\n  const [head, setHead] = useState()\n\n  useEffect(() => {\n    const fetchingHead = async () => {\n      const fetched = await client.fetchHead()\n      setHead(fetched)\n    }\n    fetchingHead()\n  }, [client])\n\n  useEffect(() => {\n    let mounted = true\n    if (!head) return\n\n    const minersList = Object.keys(miners)\n      .slice(0, 50)\n      .map(d => miners[d].address)\n    asyncPool(5, minersList, async minerId => {\n      if (!mounted) return\n      const deadlines = await client.fetchDeadlines(minerId, head)\n      if (!mounted) return\n      minersDeadlines[minerId] = deadlines.nextDeadlines\n      return await setMinersDeadlines({ ...minersDeadlines })\n    })\n\n    return () => {\n      mounted = false\n    }\n  }, [client, head, miners])\n\n  return (\n    <section id='LookUp' className='container'>\n      Listing WindowPoSt duties of the top 50 miners.\n      {miners &&\n        Object.keys(miners)\n          .slice(0, 50)\n          .map((d, i) => (\n            <div key={i}>\n              <Link to={`/miners/${miners[d].address}`}>\n                {miners[d].address}\n              </Link>\n\n              <WindowPoSt\n                deadlines={minersDeadlines[miners[d].address]}\n                head={head}\n              />\n            </div>\n          ))}\n    </section>\n  )\n}\n","import React from 'react'\nimport { Link } from 'react-router-dom'\n\nexport default function MinerBar ({\n  client,\n  miners,\n  minerId,\n  deadlineId,\n  miner\n}) {\n  return (\n    <div className='section minerbar'>\n      {/* <div>{miner && miner.info && JSON.stringify(miner.info)}</div> */}\n      <div className='minerId'>\n        {!deadlineId && (\n          <>\n            <Link to={`/miners/${minerId}`}>{minerId}</Link>\n            <span className='tinyarrow'>\n              <a href={`https://filfox.info/en/address/${minerId}`}></a>\n            </span>\n            {miner && miner.deposits && +miner.deposits.FeeDebt !== 0 && (\n              <span className='rekt'>DEBT</span>\n            )}\n          </>\n        )}\n        {deadlineId && (\n          <>\n            <Link to={`/miners/${minerId}/deadlines/${deadlineId}`}>\n              Deadline {deadlineId}\n            </Link>\n          </>\n        )}\n      </div>\n      {deadlineId && (\n        <>\n          <div className='backto'>\n            <Link to={`/miners/${minerId}`}>\n              See miner\n              <span className='bolder'> {minerId}</span>\n            </Link>\n          </div>\n        </>\n      )}\n      {!deadlineId && (\n        <div>\n          {miners && miners[minerId] && miners[minerId].tag && (\n            <span className='miner-name'>\n              {miners[minerId].tag.name}\n\n              {miners && miners[minerId].location && (\n                <span> {miners[minerId].location.flagEmoji}</span>\n              )}\n            </span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { useParams, withRouter } from 'react-router-dom'\nimport ReactTooltip from 'react-tooltip'\nimport WindowPoSt from '../components/WindowPoSt'\nimport Summary from '../components/Summary'\nimport asyncPool from 'tiny-async-pool'\nimport MinerBar from '../components/MinerBar'\nconst d3 = require('d3')\nconst f = d3.format(',')\nconst f2 = d3.format(',.1f')\n\nfunction Deadline ({ miners, client, head }) {\n  const { minerId, deadlineId } = useParams()\n  const [partitions, setPartitions] = useState()\n  // const [miner, setMiner] = useState({ id: minerId })\n  const [minerDeadlines, setMinerDeadlines] = useState({})\n  const [todayDeadlines, setTodayDeadlines] = useState()\n\n  const deadlinesArray = () => {\n    return Object.keys(minerDeadlines)\n      .sort((a, b) => +a - +b)\n      .map(k => [k, minerDeadlines[k]])\n  }\n\n  const deadlineArray = i => {\n    return deadlinesArray()\n      .map(([epoch, deadlines]) => {\n        return deadlines.deadlines[i]\n      })\n      .flat()\n  }\n\n  useEffect(() => {\n    if (!todayDeadlines) return\n    client\n      .fetchPartitionsSectors(todayDeadlines.deadlines[deadlineId].Partitions)\n      .then(d => {\n        setPartitions(d)\n      })\n  }, [todayDeadlines])\n\n  useEffect(() => {\n    if (!minerId || !head || !deadlineId) {\n      return\n    }\n\n    let mounted = true\n    let firstTime = true\n    const continueLoad = () => firstTime || mounted\n\n    const epochs = [...Array(38)].map((_, i) => ({\n      height: head.Height - i * 2880,\n      day: i\n    }))\n\n    if (todayDeadlines) {\n      if (head.Height < todayDeadlines.deadlines[deadlineId].Close) {\n        console.log(head.Height, todayDeadlines.deadlines[deadlineId].Close)\n        return\n      }\n    }\n\n    try {\n      asyncPool(40, epochs, async ({ day, height }) => {\n        try {\n          const prevHead = await client.fetchTipsetHead(height)\n          if (!continueLoad()) return\n          const deadlines = await client.fetchDeadlines(minerId, prevHead)\n          if (!continueLoad()) return\n          minerDeadlines[day] = deadlines\n          setMinerDeadlines({ ...minerDeadlines })\n          if (day === 0) {\n            setTodayDeadlines(deadlines)\n          }\n        } catch (e) {\n          console.log('could not find', day, height)\n        }\n      })\n    } catch (e) {\n      console.log('trouble with ', e)\n    }\n\n    return () => {\n      mounted = false\n    }\n  }, [client, head, minerId, deadlineId, todayDeadlines])\n\n  return (\n    <section className='container'>\n      <MinerBar\n        client={client}\n        miners={miners}\n        minerId={minerId}\n        deadlineId={deadlineId}\n      />\n      <div className='section wpost'>\n        <div className='grid'>\n          {minerDeadlines && minerDeadlines[0] && (\n            <Summary\n              title={`${f2(\n                (+minerDeadlines[0].deadlines[deadlineId].LiveSectors * 32) /\n                  1024\n              )} TiB`}\n              desc={`${f(\n                minerDeadlines[0].deadlines[deadlineId].LiveSectors\n              )} Live Sectors`}\n            />\n          )}\n          {minerDeadlines && minerDeadlines[0] && (\n            <Summary\n              title={`${f2(\n                +minerDeadlines[0].deadlines[deadlineId].FaultyPower.Raw /\n                  (1024 * 1024 * 1024 * 1024)\n              )} TiB`}\n              desc={`${f(\n                +minerDeadlines[0].deadlines[deadlineId].FaultyPower.Raw /\n                  ((1024 * 1024 * 1024 * 1024) / 32)\n              )} Faulty Sectors`}\n            />\n          )}\n        </div>\n      </div>\n      <div className='section wpost'>\n        <div className='row'>\n          <div className='col section-title'>\n            <h3>History</h3>\n            <a data-tip data-for='wpost-desc'>\n              (what is this?)\n            </a>\n            <ReactTooltip id='wpost-desc' effect='solid' place='top'>\n              <span>\n                List of 48 WindowPoSt submission deadlines ordered by due time\n                (in epochs).\n                <br />\n                Bars represent ~8TB disks to be proven, white are healthy disks,\n                red are faulty.\n              </span>\n            </ReactTooltip>\n          </div>\n        </div>\n        <WindowPoSt\n          link={d => `/miners/${minerId}/deadlines/${deadlineId}`}\n          deadlines={deadlineArray(deadlineId)}\n          head={head}\n          out={({ d, head, i }) => (i === 0 ? `Today` : `${i}d ago`)}\n        />\n      </div>\n      <div className='section sectors'>\n        <div className='row'>\n          <div className='col section-title'>\n            <h3>Sectors</h3>\n            <a data-tip data-for='sectors-desc'>\n              (what is this?)\n            </a>\n            <ReactTooltip id='sectors-desc' effect='solid' place='top'>\n              <span>Each square is a 32GiB sector.</span>\n            </ReactTooltip>\n          </div>\n        </div>\n        {partitions && (\n          <div>\n            {partitions.map((partition, i) => (\n              <div key={i}>\n                <h4>\n                  Partition {i}{' '}\n                  {Object.keys(partition[0].Faults).length ===\n                    partition[0].Sectors.length && (\n                    <span className='rekt'>REKT</span>\n                  )}\n                </h4>\n                <div className='s-partition'>\n                  {partition[0].Sectors.map(sector => (\n                    <div\n                      key={sector}\n                      className={`s-sector ${partition[0].Faults[sector] &&\n                        'faulty'} ${partition[0].Terminated[sector] &&\n                        'terminated'} ${partition[0].Recoveries[sector] &&\n                        'recovering'}`}\n                    >\n                      <span>{sector}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </section>\n  )\n}\n\nexport default withRouter(Deadline)\n","import React, { useState, useEffect } from 'react'\nimport { useParams, withRouter } from 'react-router-dom'\n\nimport Summary from '../components/Summary'\nimport ReactTooltip from 'react-tooltip'\nimport WindowPoSt from '../components/WindowPoSt'\nimport MinerBar from '../components/MinerBar'\n\nconst d3 = require('d3')\nconst f = d3.format(',')\nconst f2 = d3.format(',.0f')\n\nfunction MinerInfo ({ client, miners, head, actors }) {\n  const { minerId } = useParams()\n  const [miner, setMiner] = useState({ id: minerId })\n\n  const sectorFaultFee =\n    actors &&\n    client.computeEconomics(head, actors, {\n      projectedDays: 1\n    }).sectorFaultFee\n\n  // On new (hash or head): fetch miner\n  useEffect(() => {\n    if (!minerId || !head || !client) {\n      return\n    }\n\n    let mounted = true\n\n    const fetchInfo = () => {\n      setMiner({ ...miner })\n\n      client\n        .fetchMinerInfo(minerId, head)\n        .then(info => {\n          if (mounted) {\n            miner.info = info\n            setMiner({ ...miner })\n          }\n        })\n        .catch(e => {\n          console.error('failed to fetch miner info')\n        })\n\n      client\n        .fetchDeadlines(minerId, head)\n        .then(deadlines => {\n          if (mounted) {\n            miner.deadlines = deadlines\n            setMiner({ ...miner })\n            console.log('deadlines setting')\n          }\n        })\n        .catch(e => {\n          console.error('failed to fetch deadlines')\n        })\n\n      client\n        .fetchDeposits(minerId, head)\n        .then(deposits => {\n          if (mounted) {\n            miner.deposits = deposits\n            setMiner({ ...miner })\n          }\n        })\n        .catch(e => {\n          console.error('failed to fetch deposits')\n        })\n\n      client\n        .fetchPreCommittedSectors(minerId, head)\n        .then(preCommits => {\n          if (mounted) {\n            miner.preCommits = preCommits\n            setMiner({ ...miner })\n          }\n        })\n        .catch(e => {\n          console.error('failed to fetch precommitted sectors', e)\n        })\n    }\n\n    fetchInfo()\n\n    return () => {\n      mounted = false\n    }\n  }, [client, head, minerId])\n\n  if (!miner || !head) {\n    return <></>\n  }\n\n  return (\n    <section className='container'>\n      <MinerBar\n        client={client}\n        miners={miners}\n        minerId={minerId}\n        miner={miner}\n      />\n      <div id='deposits' className='section'>\n        <div className='grid'>\n          {miner.deposits && (\n            <Summary\n              title={`${f(miner.deposits.Balance || 0)} FIL`}\n              desc='Balance'\n            />\n          )}\n\n          {miner.deposits && (\n            <Summary\n              title={`${f(miner.deposits.Available || 0)} FIL`}\n              desc='Available'\n            />\n          )}\n\n          {miner.deposits && (\n            <Summary\n              desc='Vesting'\n              title={`${f(miner.deposits.LockedFunds || 0)} FIL`}\n            />\n          )}\n        </div>\n        <div className='grid grid-4'>\n          {miner.deposits && (\n            <Summary\n              title={`${f(miner.deposits.InitialPledge || 0)} FIL`}\n              desc='Initial Pledge'\n            />\n          )}\n          {miner.deposits && (\n            <Summary\n              desc='PreCommit Deposit'\n              title={`${f(miner.deposits.PreCommitDeposits || 0)} FIL`}\n            />\n          )}\n          {miner.deposits && (\n            <Summary\n              title={`${f(miner.deposits.FeeDebt || 0)} FIL`}\n              desc='Fee Debt'\n            />\n          )}\n          {miner.deposits && sectorFaultFee && (\n            <Summary\n              title={`${f2(\n                (+miner.deposits.Available + +miner.deposits.LockedFunds) /\n                  +sectorFaultFee || 0\n              )}`}\n              desc='Faults to Debt'\n            />\n          )}\n        </div>\n      </div>\n\n      <div id='sectors'>\n        <div className='grid grid-4'>\n          {miner.deadlines && (\n            <Summary\n              title={`${f2((miner.deadlines.SectorsCount * 32) / 1024)} TiB`}\n              desc={`${f(miner.deadlines.SectorsCount || 0)} Total Sectors`}\n            />\n          )}\n          {miner.deadlines && (\n            <Summary\n              title={`${f2((miner.deadlines.ActiveCount * 32) / 1024)} TiB`}\n              desc={`${f(miner.deadlines.ActiveCount || 0)} Active Sectors`}\n            />\n          )}\n          {miner.deadlines && (\n            <Summary\n              title={`${f2((miner.deadlines.FaultsCount * 32) / 1024)} TiB`}\n              desc={`${f(miner.deadlines.FaultsCount || 0)} Faulty Sectors`}\n            />\n          )}\n          {miner.preCommits && (\n            <Summary title={f(miner.preCommits.Count || 0)} desc='PreCommits' />\n          )}\n        </div>\n      </div>\n\n      {miner.deadlines && (\n        <div className='section wpost'>\n          <div className='row'>\n            <div className='col section-title'>\n              <h3>Deadlines</h3>\n              <a data-tip data-for='wpost-desc'>\n                (what is this?)\n              </a>\n              <ReactTooltip id='wpost-desc' effect='solid' place='top'>\n                <span>\n                  List of 48 WindoPoSt submission deadlines ordered by due time\n                  (in epochs).\n                  <br />\n                  Bars represent ~8TB disks to be proven, white are healthy\n                  disks, red are faulty.\n                </span>\n              </ReactTooltip>\n            </div>\n          </div>\n          <WindowPoSt\n            minerId={minerId}\n            deadlines={miner.deadlines.nextDeadlines}\n            head={head}\n          />\n        </div>\n      )}\n\n      {miner.deadlines && (\n        <div className='section'>\n          <div className='row'>\n            <div className='col section-title'>\n              <h3>Upcoming Deadline</h3>\n            </div>\n          </div>\n          <div className='row'>\n            <div className='col'>\n              <div className='timeline'></div>\n              <ul>\n                <li>\n                  PoStSubmissions:\n                  {miner.deadlines.nextDeadlines[0].PostSubmissions}\n                </li>\n                <li>\n                  Sectors to Prove:{' '}\n                  {miner.deadlines.nextDeadlines[0].LiveSectors}\n                </li>\n                <li>Current Deadline: {miner.deadlines.deadline.Index}</li>\n                <li>\n                  FaultCutoff:{' '}\n                  {miner.deadlines.deadline.FaultCutoff - head.Height}\n                </li>\n                <li>\n                  Challenge: {miner.deadlines.deadline.Challenge - head.Height}\n                </li>\n                <li>\n                  {miner.deadlines.deadline.Open - head.Height > 0\n                    ? 'Open'\n                    : 'Opened'}\n                  : {miner.deadlines.deadline.Open - head.Height}\n                </li>\n                <li>Close: {miner.deadlines.deadline.Close - head.Height}</li>\n              </ul>\n            </div>\n            <div className='col'>\n              <WindowPoSt\n                minerId={minerId}\n                deadlines={[miner.deadlines.nextDeadlines[0]]}\n                head={head}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {miner.preCommits && (\n        <div id='provecommit' className='section'>\n          <div className='row'>\n            <div className='col section-title'>\n              <h3>New sectors</h3>\n              <a data-tip data-for='provecommit-desc'>\n                (what is this?)\n              </a>\n              <ReactTooltip id='provecommit-desc' effect='solid' place='top'>\n                <span>\n                  List of ProveCommits ordered by due time (in epochs).\n                  <br />\n                  Circles represent sectors to be proven.\n                </span>\n              </ReactTooltip>\n            </div>\n          </div>\n          <div className='deadlines provecommit'>\n            {miner.preCommits.PreCommitDeadlines.map((d, i) => (\n              <div key={i} className='deadline'>\n                <div className='out'>\n                  In {d.Expiry - head.Height}\n                  {/* <span className=\"epochs\">epochs</span> */}\n                </div>\n                <div className='hddWrapper'>\n                  <div className='in'>\n                    {Math.round(d.Sectors.length)} sectors\n                  </div>\n                  <div className='hdds'>\n                    {d.Sectors.map(v => (\n                      <div key={v} className='hdd'>\n                        {''}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </section>\n  )\n}\n\nexport default withRouter(MinerInfo)\n","export default async function () {\n  return await (await fetch('https://api3.drand.sh/health')).json()\n}\n","import React, { useState, useEffect } from 'react'\nimport Drand from '../services/drand'\n\nconst d3 = require('d3')\nconst f = d3.format(',')\n\nfunction getFilecoinExpectedHeight () {\n  const filGenesis = new Date('2020-08-24 22:00:00Z').getTime()\n  return Math.floor((Date.now() - filGenesis) / 1000 / 30)\n}\n\nexport default function TinySummary ({ client, head }) {\n  const [expected, setFilExpectedHeight] = useState(getFilecoinExpectedHeight())\n  const [round, setRound] = useState()\n\n  useEffect(() => {\n    let mounted = true\n\n    const fetchingHead = async () => {\n      Drand().then(fetched => {\n        if (!mounted) return\n        if (round && fetched.current === round.current) {\n          console.log('   repeated drand, skip')\n          return\n        }\n        console.log('   new drand', fetched)\n        setRound(fetched)\n      })\n\n      if (getFilecoinExpectedHeight() !== expected) {\n        setFilExpectedHeight(getFilecoinExpectedHeight())\n      }\n    }\n\n    fetchingHead()\n\n    const interval = setInterval(() => {\n      if (mounted) {\n        fetchingHead()\n      }\n    }, 5000)\n\n    return () => {\n      mounted = false\n      clearInterval(interval)\n      console.log('removing interval')\n    }\n  }, [client, head, round])\n\n  return (\n    <div className='tiny-grid'>\n      {head && expected && (\n        <div>\n          Filecoin Status{' '}\n          <span>\n            {head.Height < expected\n              ? expected - head.Height === 1\n                ? 'gathering blocks'\n                : 'catching up'\n              : 'ok'}\n          </span>\n        </div>\n      )}\n      {head && (\n        <div className='tiny'>\n          Current Tipset{' '}\n          <a href={`https://filfox.info/en/tipset/${head.Height}`}>\n            {f(head.Height)}\n          </a>\n        </div>\n      )}\n      {expected && (\n        <div className='tiny'>\n          Expected Tipset{' '}\n          <a href={`https://filfox.info/en/tipset/${expected}`}>\n            {f(expected)}\n          </a>\n        </div>\n      )}\n      {round && (\n        <>\n          <div className='tiny'>\n            Drand Status{' '}\n            <span>{round.current < round.expected ? 'catching up' : 'ok'}</span>\n          </div>\n          <div className='tiny'>\n            Current Drand{' '}\n            <a href={`https://api.drand.sh/public/${round.current}`}>\n              {f(round.current)}\n            </a>\n          </div>\n          <div className='tiny'>\n            Expected Drand{' '}\n            <a href={`https://api.drand.sh/public/${round.expected}`}>\n              {f(round.expected)}\n            </a>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n","import React, { useState, useEffect, useRef } from 'react'\nimport { withRouter } from 'react-router-dom'\nimport Chart from 'chart.js'\nimport Stats, {\n  objectMap,\n  objectFilter,\n  growthRate,\n  wpostToSectors\n} from '../services/filecoin/stats'\n\n// number of consecutive block we take the average from\nconst averageLength = 3\n\nfunction Gas ({ client, head }) {\n  const [stats, setStat] = useState()\n\n  const updateStats = async () => {\n    const s = new Stats(client, averageLength)\n    await s.fetchCids()\n    setStat(s)\n  }\n\n  useEffect(() => {\n    updateStats()\n  }, [client, head])\n\n  if (!stats) return <></>\n\n  return (\n    <div className='row'>\n      <div className='accordion col-12' id='accordionExample'>\n        <GrowthCard nstats={stats} head={head} />\n        <MinerInfoCard nstats={stats} />\n        <BiggestGasSpenderCard nstats={stats} head={head} />\n        <GasTableCard nstats={stats} head={head} />\n      </div>\n    </div>\n  )\n}\n\nfunction GrowthCard ({ nstats, head }) {\n  const [commits, setCommits] = useState({})\n  const [wposts, setWposts] = useState({})\n  const [graph, setGraph] = useState(undefined)\n  const maxRounds = 30\n  const canvasRef = useRef(null)\n  const cardRef = useRef(null)\n\n  const setCollapseEvent = g => {\n    cardRef.current.addEventListener('show.bs.collapse', function () {\n      g.update()\n    })\n    cardRef.current.addEventListener('hide.bs.collapse', function () {\n      g.update()\n    })\n  }\n\n  const options = {\n    title: {\n      display: true,\n      text: 'Growth rate and proven sectors'\n    },\n    scales: {\n      yAxes: [\n        {\n          id: 'commits',\n          type: 'linear',\n          position: 'left',\n          scaleLabel: {\n            labelString: 'Estimated Growth Rate (PB/day) ',\n            display: true\n          }\n        },\n        {\n          id: 'wposts',\n          type: 'linear',\n          position: 'right',\n          scaleLabel: {\n            labelString: 'Estimated Sectors Proven per height',\n            display: true\n          }\n        }\n      ]\n    }\n  }\n\n  const fillDataset = async () => {\n    const allSealed = await nstats.transactionsPerHeight(7)\n    const allProven = await nstats.transactionsPerHeight(5)\n    // convert those to only the number of transactions per height\n    const sealed = Object.fromEntries(\n      objectMap(allSealed, (v, k) => [k, v.length])\n    )\n    const proven = Object.fromEntries(\n      objectMap(allProven, (v, k) => [k, v.length])\n    )\n    // merge what we have with potentially new stuff - overwrite old data\n    // with new data if same height\n    const newCommits = { ...commits, ...sealed }\n    const newWposts = { ...wposts, ...proven }\n    // sort in decreasing order, take some of it then show it in reverse\n    // order\n    const rounds = objectMap(newCommits, (v, k) => k)\n      .sort((a, b) => b - a)\n      .slice(0, maxRounds)\n      .reverse()\n    // filter only rounds selected and convert to growth rate\n    const filteredCommits = objectFilter(newCommits, (v, k) =>\n      rounds.includes(k)\n    )\n    setCommits(filteredCommits)\n    const dataCommits = rounds\n      .map(r => filteredCommits[r])\n      .map(c => Math.round(growthRate(c)))\n    // filter only rounds selected and convert to number of sectors\n    const filteredPosts = objectFilter(newWposts, (v, k) => rounds.includes(k))\n    setWposts(filteredPosts)\n    const dataWposts = rounds\n      .map(r => filteredPosts[r])\n      .map(w => Math.round(wpostToSectors(w)))\n    var myGraph = graph\n    if (myGraph == undefined) {\n      const dataset = [\n        {\n          data: dataCommits,\n          borderColor: chartColors.blue,\n          fill: false,\n          label: 'Estimated growth rate in PB per day',\n          yAxisID: 'commits'\n        },\n        {\n          data: dataWposts,\n          borderColor: chartColors.red,\n          fill: false,\n          label: 'Estimated number of proven sectors per height',\n          yAxisID: 'wposts'\n        }\n      ]\n      const lineData = {\n        datasets: dataset,\n        labels: rounds\n      }\n      const ctx = canvasRef.current.getContext('2d')\n      const newGraph = new Chart(ctx, {\n        type: 'line',\n        data: lineData,\n        options: options\n      })\n      myGraph = newGraph\n      setCollapseEvent(myGraph)\n    } else {\n      myGraph.data.datasets[0].data = dataCommits\n      myGraph.data.datasets[1].data = dataWposts\n      myGraph.data.labels = rounds\n      myGraph.update()\n    }\n    setGraph(myGraph)\n  }\n\n  useEffect(() => {\n    fillDataset()\n  }, [head, nstats])\n\n  return (\n    <div className='card'>\n      <div className='card-header' id='growth'>\n        <h2>\n          <button\n            className='btn btn-link'\n            type='button'\n            data-toggle='collapse'\n            data-target='#collapseGrowth'\n            aria-expanded='true'\n            aria-controls='collapseBiggest'\n          >\n            Growth evolution\n          </button>\n        </h2>\n      </div>\n      <div\n        id='collapseGrowth'\n        ref={cardRef}\n        className='collapse'\n        aria-labelledby='growth'\n        data-parent='#accordionExample'\n      >\n        <div className='card-body'>\n          <div className='col-12'>\n            {graph == undefined && <p> Loading.... </p>}\n            <canvas ref={canvasRef}>Loading...</canvas>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction MinerInfoCard ({ nstats }) {\n  const headers = [\n    'Miner',\n    'Raw Byte Power',\n    'Ratio over total raw power',\n    'Size',\n    'Daily gas required (wpost)',\n    'Daily price FIL'\n  ]\n\n  const [minerAddr, setAddr] = useState('')\n  const [data, setData] = useState({})\n\n  const drawHeaders = v => v.map(h => <th key={h}> {h} </th>)\n  const searchMiner = async e => {\n    e.preventDefault()\n    console.log('search miner for ', minerAddr)\n    const res = await nstats.minerInfo(minerAddr)\n    setData(res)\n  }\n\n  return (\n    <div className='card'>\n      <div className='card-header' id='minerInfo'>\n        <h2>\n          <button\n            className='btn btn-link'\n            type='button'\n            data-toggle='collapse'\n            data-target='#collapseInfo'\n            aria-expanded='true'\n            aria-controls='collapseInfo'\n          >\n            Miner info search\n          </button>\n        </h2>\n      </div>\n      <div\n        id='collapseInfo'\n        className='collapse'\n        aria-labelledby='minerInfo'\n        data-parent='#accordionExample'\n      >\n        <div className='card-body'>\n          <div className='row'>\n            <div className='col-4'> </div>\n            <form>\n              <div className='form-group'>\n                <label for='minerAddress'>Miner address</label>\n                <input\n                  value={minerAddr}\n                  onChange={e => setAddr(e.target.value)}\n                  type='text'\n                  className='form-control'\n                  placeholder='Enter miner address'\n                />\n              </div>\n              <button\n                onClick={searchMiner}\n                type='submit'\n                className='btn btn-primary'\n              >\n                Search\n              </button>\n            </form>\n          </div>\n          <div className='row'>\n            <div className='col-12'>\n              <table className='table table-hover'>\n                <thead>\n                  <tr>{drawHeaders(headers)}</tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td> {minerAddr} </td>\n                    <td> {data.raw} </td>\n                    <td> {data.ratio} </td>\n                    <td> {data.size} </td>\n                    <td> {data.dailyGas} </td>\n                    <td> {data.maxDailyPrice} </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction BiggestGasSpenderCard ({ head, nstats }) {\n  const [dataset, setData] = useState({})\n  const [opts, setOpts] = useState({})\n  const [pie, setPie] = useState(undefined)\n  const maxUser = 10\n  const canvasRef = useRef(null)\n  const cardRef = useRef(null)\n\n  const setCollapseEvent = pie => {\n    cardRef.current.addEventListener('show.bs.collapse', function () {\n      pie.update()\n    })\n    cardRef.current.addEventListener('hide.bs.collapse', function () {\n      pie.update()\n    })\n  }\n\n  const fillDataset = async () => {\n    const allHeights = await nstats.biggestGasUserFor()\n    if (Object.keys(allHeights).length < 1) {\n      return\n    }\n    const sortedHeight = Object.keys(allHeights).sort((a, b) => b - a)\n    const data = allHeights[sortedHeight[0]]\n    const rawData = data.slice(0, maxUser).map(d => d[1])\n    const datasets = [\n      {\n        data: rawData,\n        backgroundColor: objectMap(chartColors, (color, name) => color).slice(\n          0,\n          maxUser\n        ),\n        label: 'transaction gas'\n      }\n    ]\n    const labels = data.slice(0, maxUser).map(d => d[0])\n    const newOpts = {\n      title: {\n        display: true,\n        text: `Gas usage at height ${sortedHeight[0]}`\n      }\n    }\n    const newDataset = {\n      datasets: datasets,\n      labels: labels\n    }\n    setOpts(newOpts)\n    setData(newDataset)\n\n    var myPie = pie\n    if (myPie == undefined) {\n      const ctx = canvasRef.current.getContext('2d')\n      const newPie = new Chart(ctx, {\n        type: 'doughnut',\n        data: newDataset,\n        options: newOpts\n      })\n      myPie = newPie\n      setCollapseEvent(myPie)\n    } else {\n      pie.data.datasets[0].data = rawData\n      pie.options = newOpts\n      pie.update()\n    }\n    setPie(myPie)\n  }\n\n  useEffect(() => {\n    fillDataset()\n  }, [head, nstats])\n\n  return (\n    <div className='card'>\n      <div className='card-header' id='biggestGas'>\n        <h2>\n          <button\n            className='btn btn-link'\n            type='button'\n            data-toggle='collapse'\n            data-target='#collapseBiggest'\n            aria-expanded='true'\n            aria-controls='collapseBiggest'\n          >\n            Biggest gas users\n          </button>\n        </h2>\n      </div>\n      <div\n        id='collapseBiggest'\n        ref={cardRef}\n        className='collapse'\n        aria-labelledby='biggestGas'\n        data-parent='#accordionExample'\n      >\n        <div className='card-body'>\n          <div className='col-12'>\n            {pie == undefined && <p> Loading.... </p>}\n            <canvas ref={canvasRef}>Loading...</canvas>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction GasTableCard ({ nstats, head }) {\n  const headers = [\n    '',\n    'Average Count',\n    'Average GasUsed ',\n    'Ratio over total GasUsed',\n    'Average GasLimit',\n    'Ratio avg over total GasLimit',\n    'Ratio GasUsed over GasLimit',\n    'Ratio GasUsed over BlockLimit',\n    'Ratio GasLimit over BlockLimit'\n  ]\n  const empty = Array(headers.length - 1).fill(0)\n  const [avgGas, setAvgGas] = useState({\n    headers: headers,\n    total: empty,\n    wpost: empty,\n    pre: empty,\n    prove: empty\n  })\n\n  const updateAverage = async nstats => {\n    const totalGasUsed = await nstats.avgTotalGasUsed()\n    const totalGasLimit = await nstats.avgGasLimit()\n\n    const computeEntry = async (...method) => {\n      const nTx = await nstats.avgNumberTx(...method)\n      const gasUsed = await nstats.avgGasOfMethod(...method)\n      const gasLimit = await nstats.avgGasLimit(...method)\n      const ratioUsed = await nstats.avgRatioUsedOverTotalUsed(...method)\n      const ratioLimit = await nstats.avgRatioLimitOverTotalLimit(...method)\n      const ratioUsedLimit = await nstats.avgRatioUsedOverLimit(...method)\n      const ratioUsedBlockLimit = await nstats.avgTotalGasUsedOverTipsetLimit(\n        ...method\n      )\n      const ratioBlockLimit = await nstats.avgTotalGasLimitOverTipsetLimit(\n        ...method\n      )\n      return [\n        nTx,\n        gasUsed,\n        ratioUsed,\n        gasLimit,\n        ratioLimit,\n        ratioUsedLimit,\n        ratioUsedBlockLimit,\n        ratioBlockLimit\n      ]\n    }\n    const results = {}\n    results.headers = headers\n    results.total = await computeEntry()\n    results.wpost = await computeEntry(5)\n    results.pre = await computeEntry(6)\n    results.prove = await computeEntry(7)\n    setAvgGas(results)\n  }\n\n  useEffect(() => {\n    updateAverage(nstats)\n  }, [nstats, head])\n\n  const drawHeaders = v => v.map(h => <th key={h}> {h} </th>)\n\n  return (\n    <div className='card'>\n      <div className='card-header' id='headingOne'>\n        <h2>\n          <button\n            className='btn btn-link'\n            type='button'\n            data-toggle='collapse'\n            data-target='#collapseOne'\n            aria-expanded='false'\n            aria-controls='collapseOne'\n          >\n            Gas usage table\n          </button>\n        </h2>\n      </div>\n      <div\n        id='collapseOne'\n        className='collapse'\n        aria-labelledby='headingOne'\n        data-parent='#accordionExample'\n      >\n        <div className='card-body'>\n          <div className='row'>\n            <p>\n              {' '}\n              This table shows different statistics about the gas usage per\n              epoch. All results are averaged accross the last\n              {averageLength} epochs. You can find a complete description of\n              each column below the table.{' '}\n            </p>\n            <div className='row'>\n              <div className='col-12'>\n                <table className='table table-hover'>\n                  <thead>\n                    <tr>{drawHeaders(avgGas.headers)}</tr>\n                  </thead>\n                  <tbody>\n                    <RowInfo name='Total gas used:' values={avgGas.total} />\n                    <RowInfo name='WindowPoSt:' values={avgGas.wpost} />\n                    <RowInfo name='PreCommit:' values={avgGas.pre} />\n                    <RowInfo name='ProveCommit:' values={avgGas.prove} />\n                  </tbody>\n                </table>\n              </div>\n            </div>\n            <div className='row'>\n              <div className='col-0'> </div>\n              <div className='col-11'>\n                <ul className='list-group list-group-flush'>\n                  <li className='list-group-item'>\n                    <b>Average Count:</b> number of transaction per epoch in\n                    average of the method{' '}\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Average GasUsed:</b> gas used per transaction of the\n                    method\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Ratio over total GasUsed:</b> Precedent number divided by\n                    the total gas used accross all epochs\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Average GasLimit:</b> gas limit set per transaction of\n                    the method\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Ratio over total GasLimit:</b> Precedent number divided\n                    by the total gas used accross all epochs\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Ratio GasUsed over GasLimit:</b> Total gas used for the\n                    method over total gas limit set accross all epoch\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Total GasUsed over BlockLimit:</b> Total gas used divided\n                    by total gas limit set per epoch\n                  </li>\n                  <li className='list-group-item'>\n                    <b>Total GasLimit over BlockLimit:</b> precedent number\n                    divided by total gas limit set per epoch\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// RowInfo is simply a row of the table filled by the main table\nfunction RowInfo (props) {\n  const showValues = vv =>\n    vv.map((v, idx) => (\n      <td key={idx.toString()}>\n        {isNaN(v) || Math.ceil(v) === v ? v : v.toFixed(2)}\n      </td>\n    ))\n\n  return (\n    <tr>\n      <td> {props.name} </td>\n      {showValues(props.values)}\n    </tr>\n  )\n}\n\nexport default withRouter(Gas)\n\nconst chartColors = {\n  red: 'rgb(255, 99, 132)',\n  orange: 'rgb(255, 159, 64)',\n  yellow: 'rgb(255, 205, 86)',\n  green: 'rgb(75, 192, 192)',\n  blue: 'rgb(54, 162, 235)',\n  purple: 'rgb(153, 102, 255)',\n  grey: 'rgb(201, 203, 207)'\n}\n","import React, { useState, useEffect } from 'react'\nimport { HashRouter as Router, Switch, Route, Link } from 'react-router-dom'\n\nimport Filecoin from './services/filecoin'\n\nimport Home from './views/Home'\nimport Status from './views/Status'\nimport Full from './views/Full'\nimport Deadline from './views/Deadline'\nimport MinerInfo from './views/MinerInfo'\nimport TinySummary from './components/TinySummary'\nimport Gas from './views/Gas'\n\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\nimport './App.scss'\n\nfunction App () {\n  console.log('reloaded')\n  const [miners, setMiners] = useState()\n  const [head, setHead] = useState()\n  const [node, setNode] = useState('wss://node.glif.io/space07/lotus/rpc/v0')\n  const [client, setFilClient] = useState(new Filecoin(node))\n  const [spa, setSpa] = useState()\n  const [actors, setActors] = useState()\n\n  useEffect(() => {\n    const reload = async () => {\n      await setHead()\n      await setFilClient(new Filecoin(node))\n    }\n\n    reload()\n  }, [node])\n\n  useEffect(() => {\n    if (!head) return\n    const fetchingEcon = async () => {\n      const actors = await client.fetchGenesisActors(head)\n      setActors(actors)\n    }\n\n    fetchingEcon()\n  }, [client, head])\n\n  // useEffect(() => {\n  //   if (!head) return\n\n  //   client.fetchPower(head).then(power => {\n  //     setSpa(power)\n  //   })\n  // }, [head, client])\n\n  useEffect(() => {\n    let mounted = true\n\n    client.getMiners().then(res => {\n      if (!mounted) return\n      setMiners(res)\n    })\n\n    const fetchingHead = async () => {\n      client.fetchHead().then(fetched => {\n        if (!mounted) return\n        if (head && fetched.Height === head.Height) {\n          console.log('   repeated block, skip')\n          return\n        }\n        console.log('   new block', fetched.Height, head && head.Height)\n        setHead(fetched)\n      })\n    }\n\n    fetchingHead()\n\n    const interval = setInterval(() => {\n      if (mounted) {\n        fetchingHead()\n      }\n    }, 5000)\n\n    return () => {\n      mounted = false\n      clearInterval(interval)\n      console.log('removing interval')\n    }\n  }, [client, head])\n\n  return (\n    <Router>\n      <div className='App'>\n        <div className='container'>\n          {/* <div className='row'>\n            <div className='col'>\n              Connected to Filecoin Network via&nbsp;\n              <select onChange={e => setNode(e.target.value)} value={node}>\n                <option value='wss://lotus.jimpick.com/spacerace_api/0/node/rpc/v0'>\n                  Jim's node 0\n                </option>\n                <option value='wss://lotus.jimpick.com/spacerace_api/1/node/rpc/v0'>\n                  Jim's node 1\n                </option>\n                <option value='ws://www.border.ninja:12342/node/rpc/v0'>\n                  Border's node\n                </option>\n                <option value='wss://node.glif.io/space07/lotus/rpc/v0'>\n                  Glif's node\n                </option>\n              </select>\n            </div>\n          </div> */}\n          <TinySummary client={client} head={head} />\n        </div>\n        <header className='container-fluid'>\n          <Link to='/'>\n            <h1 id='logo' className='logo'>\n              <span>spacegap</span>\n            </h1>\n          </Link>\n        </header>\n        <div className=\"container\">\n          <Switch>\n            <Route path='/miners/:minerId/deadlines/:deadlineId'>\n              <Deadline client={client} miners={miners} head={head} />\n            </Route>\n            <Route path='/miners/:minerId'>\n              <MinerInfo\n                actors={actors}\n                client={client}\n                miners={miners}\n                head={head}\n              />\n            </Route>\n            <Route path='/full'>\n              <Full client={client} miners={miners} />\n            </Route>\n            <Route path='/status'>\n              <Status head={head} spa={spa} client={client} miners={miners} />\n            </Route>\n            <Route path='/gas'>\n                <Gas client={client} head={head} />\n            </Route>\n            <Route path='/'>\n              <Home actors={actors} client={client} head={head} miners={miners} />\n            </Route>\n          </Switch>\n        </div>\n      </div>\n    </Router>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}